(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{259:function(e,t,a){"use strict";a.r(t);var r=a(0),s=Object(r.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h3",{attrs:{id:"zookeeper概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper概述"}},[e._v("#")]),e._v(" zookeeper概述")]),e._v(" "),a("p",[e._v("zookeeper是一种分布式协调服务，用于在分布式环境中协调和管理服务。提供的服务包括：配置服务、名字服务、分布式同步、组服务等。")]),e._v(" "),a("h4",{attrs:{id:"特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#特性"}},[e._v("#")]),e._v(" 特性")]),e._v(" "),a("ul",[a("li",[e._v("一致性：数据一致性，按照顺序。")]),e._v(" "),a("li",[e._v("原子性：事务要么成功，要么失败，不会局部化。")]),e._v(" "),a("li",[e._v("单一视图：客户端连接的任一节点，数据都是一致的。")]),e._v(" "),a("li",[e._v("可靠性：每次对zookeeper的操作都会保存在服务端。")]),e._v(" "),a("li",[e._v("实时性：客户端可以读取到zookeeper服务器的最新数据。")])]),e._v(" "),a("h4",{attrs:{id:"作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#作用"}},[e._v("#")]),e._v(" 作用")]),e._v(" "),a("ul",[a("li",[e._v("master节点选举：主节点宕机后从节点通过选举产生新的主节点，并保证主节点唯一，保证集群高可用。")]),e._v(" "),a("li",[e._v("统一配置文件管理：修改一份配置，同步到其它服务器上，减少工作量。")]),e._v(" "),a("li",[e._v("发布与订阅：发布者将数据存储在znode上，订阅者可以读取这个数据。")]),e._v(" "),a("li",[e._v("分布式锁：在分布式环境下提供锁，管理不同进程对资源的争夺。")]),e._v(" "),a("li",[e._v("集群管理：保证集群中的数据一致性。")])]),e._v(" "),a("h3",{attrs:{id:"配置zookeeper"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置zookeeper"}},[e._v("#")]),e._v(" 配置zookeeper")]),e._v(" "),a("h4",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[e._v("#")]),e._v(" 安装")]),e._v(" "),a("p",[e._v("从"),a("a",{attrs:{href:"http://zookeeper.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("zookeeper官网"),a("OutboundLink")],1),e._v("找到zookeeper的镜像地址，下载并解压。")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# 下载\nwget https://www-eu.apache.org/dist/zookeeper/zookeeper-3.4.12/zookeeper-3.4.12.tar.gz\n# 解压\ntar -zxvf zookeeper-3.4.12.tar.gz\nmv zookeeper-3.4.12 zookeeper\n")])])]),a("p",[e._v("打开/etc目录下的profile文件，为zookeeper配制环境变量，编辑完成后使用 "),a("code",[e._v("source /etc/profile")]),e._v(" 使配置生效。")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("export ZOOKEEPER_HOME=/usr/local/zookeeper\nexport PATH=$PATH:$ZOOKEEPER_HOME/bin\n")])])]),a("h4",{attrs:{id:"配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[e._v("#")]),e._v(" 配置文件")]),e._v(" "),a("p",[e._v("在zookeeper下的conf目录中有名为zoo.cfg的配置文件。")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# zookeeper的基本时间单位（ms）\ntickTime=2000\n# 集群中节点连接并同步到master节点的初始化连接时间，超时失败（tickTime的倍数）\ninitLimit=10\n# 集群中主从节点数据同步的时间限制，超时从节点被丢弃（tickTime的倍数）\nsyncLimit=5\n# zookeeper数据目录\ndataDir=/usr/local/zookeeper/data\n# zookeeper客户端连接端口\nclientPort=2181\n")])])]),a("h4",{attrs:{id:"操作zookeeper"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作zookeeper"}},[e._v("#")]),e._v(" 操作zookeeper")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# 启动\nzkServer.sh start\n# 关闭\nzkServer.sh stop\n# 重启\nzkServer.sh restart\n# 查看状态\nzkServer.sh status\n")])])]),a("h3",{attrs:{id:"zookeeper的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper的使用"}},[e._v("#")]),e._v(" zookeeper的使用")]),e._v(" "),a("h4",{attrs:{id:"zk数据模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zk数据模型"}},[e._v("#")]),e._v(" zk数据模型")]),e._v(" "),a("ul",[a("li",[e._v("zk的数据模型可以理解为文件目录。")]),e._v(" "),a("li",[e._v("每个节点成为znode，它可以有子节点，也可以有数据。")]),e._v(" "),a("li",[e._v("节点有临时和永久之分，临时节点在客户端断开后消失。")]),e._v(" "),a("li",[e._v("每个zk节点有各自的版本号，当节点数据发生变化，该节点的版本号会累加。修改节点时，版本号不匹配会报错。")]),e._v(" "),a("li",[e._v("节点存储的数据不宜过大。")]),e._v(" "),a("li",[e._v("节点可以设置acl来控制用户访问权限。")])]),e._v(" "),a("h4",{attrs:{id:"zookeeper客户端操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper客户端操作"}},[e._v("#")]),e._v(" zookeeper客户端操作")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# 通过zkCli连接zookeeper\nzkCli.sh\n# 查看指定路径下的数据/子节点节点\nls /\n# 查看指定路径下的子节点和状态信息\nstat /\n# 查看指定路径下的数据和状态信息\nget /\n# 查看指定路径下的数据、子节点和状态信息\nls2 /\n# 退出客户端\nquit\n")])])])])}),[],!1,null,null,null);t.default=s.exports}}]);